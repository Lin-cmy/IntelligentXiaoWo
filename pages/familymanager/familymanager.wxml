<view class="family-manager-container">
  <!-- щб╢щГицаЗщвШ -->
  <view class="header-section">
    <text class="page-title">хо╢х║нчобчРЖ</text>
  </view>

  <!-- хо╢х║нхИЧшби -->
  <view class="family-list-section">
    <block wx:for="{{myfamilies}}" wx:key="id">
      <view class="family-card" bindtap="onFamilyTap" data-homeid="{{item.id}}" data-identity="{{item.role}}">
        <view class="family-info">
          <view class="family-icon">ЁЯПа</view>
          <view class="family-details">
            <text class="family-name">{{item.name}}</text>
            <text class="family-identity">ш║лф╗╜: {{item.role}}</text>
          </view>
        </view>

        <!-- хИащЩдцибх╝Пф╕ЛцШ╛чд║хИащЩдцМЙщТо -->
        <view
          wx:if="{{deleteMode}}"
          class="family-delete-btn"
          catchtap="onDeleteFamily"
          data-homeid="{{item.id}}"
        >
          <text class="family-delete-minus">-</text>
        </view>
      </view>
    </block>
  </view>

  <!-- хКЯшГ╜цМЙщТохМ║ -->
  <view class="action-section">
    <view class="action-card" bindtap="onCreateTap">
      <view class="action-icon add-icon">+</view>
      <view class="action-text">
        <text class="action-title">хИЫх╗║хо╢х║н</text>
        <text class="action-desc">хИЫх╗║ф╕Аф╕кцЦ░чЪДхо╢х║нчй║щЧ┤</text>
      </view>
    </view>
    
    <view class="action-card" bindtap="onEnterTap">
      <view class="action-icon search-icon">ЁЯФН</view>
      <view class="action-text">
        <text class="action-title">шо┐щЧохо╢х║н</text>
        <text class="action-desc">цЯецЙ╛х╣╢хКахЕех╖▓цЬЙхо╢х║н</text>
      </view>
    </view>
    
    <view class="action-card" bindtap="onDeleteTap">
      <view class="action-icon delete-icon">ЁЯЧСя╕П</view>
      <view class="action-text">
        <text class="action-title">хИащЩдхо╢х║н</text>
        <text class="action-desc">ф╗Охо╢х║нхИЧшбиф╕нчз╗щЩдхо╢х║н</text>
      </view>
    </view>

    <!-- хИащЩдцибх╝Пф╕ЛцШ╛чд║хоМцИРцМЙщТо -->
    <view wx:if="{{deleteMode}}" class="finish-btn" bindtap="onFinishDelete">
      хоМцИР
    </view>
  </view>

  <!-- хИЫх╗║хо╢х║нх╝╣чкЧ -->
  <view wx:if="{{showCreatePopup}}" class="modal-overlay" catchtouchmove="true">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">хИЫх╗║хо╢х║н</text>
      </view>
      <view class="modal-body">
        <view class="input-group">
          <text class="input-label">хо╢х║нхРНчз░</text>
          <input
            class="modal-input"
            placeholder="шп╖ш╛УхЕехо╢х║нхРНчз░"
            value="{{newFamilyName}}"
            bindinput="onFamilyNameInput"
            maxlength="20"
          />
        </view>
        <view class="input-group">
          <text class="input-label">хо╢х║нхЬ░хЭА</text>
          <input
            class="modal-input"
            placeholder="шп╖ш╛УхЕехо╢х║нхЬ░хЭА"
            value="{{newFamilyAddress}}"
            bindinput="onFamilyAddressInput"
            maxlength="20"
          />
        </view>
      </view>
      <view class="modal-footer">
        <button class="modal-btn cancel" bindtap="onPopupClose">хПЦц╢И</button>
        <button class="modal-btn confirm" bindtap="onConfirmCreate">чбохоЪ</button>
      </view>
    </view>
  </view>

  <!-- шо┐щЧохо╢х║нцРЬч┤вх╝╣чкЧ -->
  <view wx:if="{{showSearchPopup}}" class="modal-overlay" catchtouchmove="true">
    <view class="modal-content search-modal">
      <view class="modal-header">
        <text class="modal-title">шо┐щЧохо╢х║н</text>
      </view>
      
      <!-- цРЬч┤вцбЖ -->
      <view class="search-box">
        <input
          class="search-input"
          placeholder="шп╖ш╛УхЕехо╢х║нхРНчз░"
          value="{{searchInput}}"
          bindinput="onSearchInput"
          maxlength="20"
          confirm-type="search"
          bindconfirm="onSearch"
        />
        <view class="search-btn" bindtap="onSearch">цРЬч┤в</view>
      </view>
      
      <!-- цРЬч┤вч╗УцЮЬ -->
      <scroll-view class="search-results" scroll-y>
        <block wx:if="{{searchfamilies.length > 0}}">
          <view 
            wx:for="{{searchfamilies}}" 
            wx:key="id"
            class="search-item {{selectedHomeId === item.id ? 'selected' : ''}}"
            bindtap="onSelectHome"
            data-homeid="{{item.id}}"
          >
            <view class="search-item-info">
              <text class="search-item-name">{{item.name}}</text>
              <text class="search-item-address">хЬ░хЭА: {{item.address}}</text>
            </view>
            <view class="search-item-check" wx:if="{{selectedHomeId === item.id}}">тЬУ</view>
          </view>
        </block>
        <view wx:elif="{{searchInput && searchfamilies.length === 0}}" class="no-results">
          <view class="no-results-icon">ЁЯФН</view>
          <text>цЬкцЙ╛хИ░чЫ╕хЕ│хо╢х║н</text>
        </view>
      </scroll-view>
      
      <!-- щАЙф╕нчЪДхо╢х║нф┐бцБп -->
      <view class="selected-home-info" wx:if="{{selectedHome}}">
        <view class="selected-home-title">х╖▓щАЙцЛй:</view>
        <view class="selected-home-name">{{selectedHome.name}}</view>
      </view>
      
      <!-- цМЙщТо -->
      <view class="modal-footer">
        <button class="modal-btn cancel" bindtap="onSearchPopupClose">хПЦц╢И</button>
        <button class="modal-btn confirm {{!selectedHomeId ? 'disabled' : ''}}" bindtap="onApplyEnter">чФ│шп╖хКахЕе</button>
      </view>
    </view>
  </view>
</view>