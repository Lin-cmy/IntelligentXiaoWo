<view class="container">
  <!-- 场景列表 -->
  <view class="scene-list">
    <block wx:for="{{scenes}}" wx:for-index="sceneKey" wx:for-item="scene" wx:key="id">
        <view class="scene-item" bindtap="onSceneDetail" data-scene="{{sceneKey}}">
          <image class="scene-image" 
            src="{{scene.imagePath || '/images/scene/定制家居.png'}}" 
            mode="aspectFill"></image>
          <view class="scene-info">
            <view class="scene-name">
              <text class="{{scene.iconClass || 'medal-icon'}}">
                {{scene.iconSymbol || '🏆'}}
              </text>
              <text>{{scene.name}}</text>
            </view>
            <view class="scene-desc">{{scene.desc}}</view>
            <view class="scene-users">附近{{randomUsers[sceneKey] || 3}}k人已启用</view>
          </view>

        <!-- 删除按钮，仅在删除模式下显示 -->
        <view class="delete-btn" wx:if="{{isDeleteMode}}" catchtap="onDeleteScene" data-id="{{scene.id}}">
          <text class="delete-icon">-</text>
        </view>
      </view>
    </block>
  </view>

  <!-- 底部按钮区域 -->
  <view class="bottom-buttons">
    <!-- 删除模式下显示完成按钮 -->
    <view class="complete-btn" wx:if="{{isDeleteMode}}" bindtap="exitDeleteMode">
      <text>完成</text>
    </view>
    
    <!-- 非删除模式下显示添加和删除按钮 -->
    <view class="action-buttons" wx:if="{{!isDeleteMode}}">
      <view class="delete-scene-btn" bindtap="toggleDeleteMode">
        <text class="delete-mode-icon">-</text>
        <text>删除场景</text>
      </view>
      
      <view class="add-scene-btn" bindtap="showAddScenePopup">
        <text class="add-icon">+</text>
        <text>添加场景</text>
      </view>
    </view>
  </view>

  <!-- 添加场景弹窗 -->
  <view class="popup-mask" wx:if="{{showAddScenePopup}}" bindtap="hideAddScenePopup" catchtouchmove="true"></view>
  <view class="popup-content" wx:if="{{showAddScenePopup}}">
    <view class="popup-name">添加场景</view>
    <input class="popup-input" placeholder="场景名称" bindinput="onSceneNameInput" value="{{newSceneName}}"/>
    <input class="popup-input" placeholder="场景描述" bindinput="onSceneDescInput" value="{{newSceneDesc}}"/>
    <view class="popup-buttons">
      <button class="popup-btn cancel" bindtap="hideAddScenePopup">取消</button>
      <button class="popup-btn confirm" bindtap="confirmAddScene">确认</button>
    </view>
  </view>
</view>