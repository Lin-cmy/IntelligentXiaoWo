<view class="detail-container">
  <!-- 顶部背景图和标题 -->
  <view class="header-section">
    <image class="bg-image" src="/images/scene-bg.jpg" mode="aspectFill"></image>
    <view class="header-content">
      <view class="back-icon" bindtap="onBack">←</view>
      <view class="like-icon">👍</view>
    </view>
    <view class="title-section">
      <view class="title">{{sceneData.title}}</view>
      <view class="desc">{{sceneData.desc}}</view>
    </view>
  </view>

  <!-- 设备列表 -->
  <view class="content-section">
    <view class="section-title">当 {{sceneData.devices[0].name}} 时</view>
    <view class="devices-list">
      <view class="device-item" wx:for="{{sceneData.devices}}" wx:key="name">
        <view class="device-icon">📱</view>
        <view class="device-info">
          <view class="device-name">{{item.name}}</view>
          <view class="device-state">{{item.state}}</view>
        </view>
      </view>
    </view>
 <!-- 已选设备列表 -->
<view class="selected-devices" wx:if="{{selectedDevices.length > 0}}">
  <view class="section-title">已添加设备</view>
  <view class="device-list">
    <view class="device-item selected" wx:for="{{selectedDevices}}" wx:key="id">
      <view class="device-info">
        <view class="device-name">{{item.name}}</view>
        <view class="device-type">{{item.type}}</view>
      </view>
      <view class="device-actions">
        <picker range="{{item.actions}}" value="0" bindchange="switchDeviceAction" data-device-id="{{item.id}}">
          <view class="action-picker">
            <text>{{item.selectedAction}}</text>
            <text class="arrow">▼</text>
          </view>
        </picker>
      </view>
      <view class="remove-btn" bindtap="removeDevice" data-device-id="{{item.id}}">
        <text>×</text>
      </view>
    </view>
  </view>
</view>

<!-- 添加设备按钮 -->
<view class="add-device-btn" bindtap="showDeviceList">
  <text class="plus-icon">+</text>
  <text>添加设备</text>
</view>

<!-- 设备列表弹窗 -->
<view class="device-list-modal" wx:if="{{showDeviceList}}">
  <view class="modal-mask" bindtap="hideDeviceList"></view>
  <view class="modal-content">
    <view class="modal-header">
      <text>选择设备</text>
      <text class="close-btn" bindtap="hideDeviceList">×</text>
    </view>
    <view class="available-device-list">
      <view class="device-item available" wx:for="{{availableDevices}}" wx:key="id" bindtap="selectDevice" data-device="{{item}}">
        <view class="device-icon">📱</view>
        <view class="device-info">
          <view class="device-name">{{item.name}}</view>
          <view class="device-type">{{item.type}}</view>
        </view>
        <view class="add-icon">+</view>
      </view>
    </view>
  </view>
</view>
  </view>

  <!-- 场景添加按钮 -->
  <!-- <view class="content-section">
    <view class="add-btn">
      <text class="plus-icon">+</text>
      <text>添加场景</text>
    </view>
  </view> -->
<!-- 日期选择 -->
<view class="form-section">
    <date-picker
      startddate="{{startdate}}"
      endddate="{{enddate}}"
      bind:change="handleDateChange"
    />
  </view>
  <!-- 时间选择 -->
  <view class="content-section">
    <view class="time-section">
      <view class="section-title">生效时间段</view>
      <view class="time-picker" bindtap="onTimeRange">
        <text>{{timeRange}}</text>
        <text class="arrow">></text>
      </view>
    </view>
  </view>

  <!-- 时间选择器 -->
  <view class="time-picker-modal" wx:if="{{showTimePicker}}">
    <picker mode="time" value="{{startTime}}" bindchange="bindStartTimeChange">
      <view class="picker-item">开始时间: {{startTime}}</view>
    </picker>
    <picker mode="time" value="{{endTime}}" bindchange="bindEndTimeChange">
      <view class="picker-item">结束时间: {{endTime}}</view>
    </picker>
  </view>

  <!-- 底部按钮 -->
  <view class="bottom-btn">
    <button class="create-scene-btn" bindtap="createScene">创建场景</button>
  </view>
</view>